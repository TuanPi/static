;(function(){function getDocHeight(){var D=document;return Math.max(Math.max(D.body.scrollHeight,D.documentElement.scrollHeight),Math.max(D.body.offsetHeight,D.documentElement.offsetHeight),Math.max(D.body.clientHeight,D.documentElement.clientHeight));}
function getDocWidth(){var D=document;return Math.max(Math.max(D.body.scrollWidth,D.documentElement.scrollWidth),Math.max(D.body.offsetWidth,D.documentElement.offsetWidth),Math.max(D.body.clientWidth,D.documentElement.clientWidth));}
function next(elem){do{elem=elem.nextSibling;}while(elem&&elem.nodeType!=1);return elem;}
function prev(elem){do{elem=elem.previousSibling;}while(elem&&elem.nodeType!=1);return elem;}
function redraw(element){element=$(element);var n=document.createTextNode(' ');element.appendChild(n);(function(){n.parentNode.removeChild(n)}).defer();return element;}
function minimizeMaximize(widget,main_block,editor){if(window.fullscreen==true){main_block.className='django-ace-editor';widget.style.width=window.ace_widget.width+'px';widget.style.height=window.ace_widget.height+'px';window.fullscreen=false;}
else{window.ace_widget={'width':widget.offsetWidth,'height':widget.offsetHeight};main_block.className='django-ace-editor-fullscreen';widget.style.height=getDocHeight()+'px';widget.style.width=getDocWidth()+'px';window.scrollTo(0,0);window.fullscreen=true;}
editor.resize();}
function apply_widget(widget){var div=widget.firstChild,textarea=next(widget),editor=ace.edit(div),mode=widget.getAttribute('data-mode'),theme=widget.getAttribute('data-theme'),wordwrap=widget.getAttribute('data-wordwrap'),toolbar=prev(widget),main_block=toolbar.parentNode;var min_max=toolbar.getElementsByClassName('django-ace-max_min');min_max[0].onclick=function(){minimizeMaximize(widget,main_block,editor);return false;};editor.getSession().setValue(textarea.value);textarea.style.display="none";if(mode){editor.getSession().setMode('ace/mode/'+mode);}
if(theme){editor.setTheme("ace/theme/"+theme);}
if(wordwrap=="true"){editor.getSession().setUseWrapMode(true);}
editor.getSession().on('change',function(){textarea.value=editor.getSession().getValue();});editor.commands.addCommands([{name:'Full screen',bindKey:{win:'Ctrl-F11',mac:'Command-F11'},exec:function(editor){minimizeMaximize(widget,main_block,editor);},readOnly:true},{name:'submit',bindKey:"Ctrl+Enter",exec:function(editor){$('form#problem_submit').submit();},readOnly:true},{name:"showKeyboardShortcuts",bindKey:{win:"Ctrl-Shift-/",mac:"Command-Shift-/"},exec:function(editor){ace.config.loadModule("ace/ext/keybinding_menu",function(module){module.init(editor);editor.showKeyboardShortcuts();});}},{name:"increaseFontSize",bindKey:"Ctrl-+",exec:function(editor){var size=parseInt(editor.getFontSize(),10)||12;editor.setFontSize(size+1);}},{name:"decreaseFontSize",bindKey:"Ctrl+-",exec:function(editor){var size=parseInt(editor.getFontSize(),10)||12;editor.setFontSize(Math.max(size-1||1));}},{name:"resetFontSize",bindKey:"Ctrl+0",exec:function(editor){editor.setFontSize(12);}}]);window[widget.id]=editor;$(widget).trigger('ace_load',[editor]);}
function init(){var widgets=document.getElementsByClassName('django-ace-widget');for(var i=0;i<widgets.length;i++){var widget=widgets[i];widget.className="django-ace-widget";apply_widget(widget);}}
if(window.addEventListener){window.addEventListener('load',init);}else if(window.attachEvent){window.attachEvent('onload',init);}})();;$(function(){function format(state){if(!state.id)return state.text;return state.text;}
window.previous_template='';function update_language_template(){var source=$('textarea#id_source');if(source.val()==window.previous_template.replace(/\r/g,'')||source.val()==''){var lang_id=$('#id_language').val();var code=localStorage.getItem('submit:'+$('#id_language').val());function update_submit_area(code){window.previous_template=code;source.val(code);window.ace_editor.getSession().setValue(code);}
if(code!=null){update_submit_area(code);}else{$.get('/widgets/template',{id:lang_id}).done(function(template){update_submit_area(template);});}}}
function makeDisplayData(data){var site_data=data.attr('data-info');var judge_data=data.attr('data-judge-info');var display_data=site_data||judge_data;return display_data;}
function formatSelection(state){if(!state.id)return state.text;var data=makeDisplayData($("option[data-id="+state.id+"]"));return"<b>"+state.text+"</b> ("+data+")";}
$.fn.select2.amd.define('select2/data/customAdapter',['select2/results','select2/utils'],function(Result,Utils){RefPresenter=function($element,options,dataAdapter){RefPresenter.__super__.constructor.call(this,$element,options,dataAdapter);};Utils.Extend(RefPresenter,Result);RefPresenter.prototype.bind=function(container,$container){container.on('results:focus',function(params){var data=makeDisplayData($("option[data-id="+params.data.id+"]"));$("#result-version-info").text(data);});RefPresenter.__super__.bind.call(this,container,$container);};return RefPresenter;});var customAdapter=$.fn.select2.amd.require('select2/data/customAdapter');$("#id_language").select2({templateResult:format,templateSelection:formatSelection,escapeMarkup:function(m){return m;},resultsAdapter:customAdapter});$('#id_language').on('select2:open',function(evt){var dropdown=$('.select2-dropdown');if(!$('#result-version-info').length)
dropdown.append($("<span id=\"result-version-info\">"));});$('#id_language').change(function(){var lang=$("#id_language").find("option:selected").attr('data-ace');window.ace_source.getSession().setMode("ace/mode/"+lang);update_language_template();});$('#ace_source').on('ace_load',function(e,editor){window.ace_editor=editor;update_language_template();editor.commands.addCommand({name:'save',bindKey:{win:'Ctrl-S',mac:'Command-S'},exec:function(){localStorage.setItem('submit:'+$('#id_language').val(),editor.getSession().getValue());}});editor.getSession().setUseWrapMode(true);editor.setFontSize(14);editor.setPrintMarginColumn(100);editor.focus();});$(window).resize(function(){$('#ace_source').height(Math.max($(window).height()-353,100));}).resize();});